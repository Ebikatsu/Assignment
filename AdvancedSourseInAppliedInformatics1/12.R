#全ての問題で前回のshidouhou.txtを読み込んで作成したデータフレームを基に計算
指導法データ<-read.table("shidouhou.txt",header=TRUE)
指導法データ
#問題1：統計テスト1を独立変数、統計テスト2を従属変数として回帰式を求める
回帰結果1<-lm(指導法データ$統計テスト2~指導法データ$統計テスト1)
summary(回帰結果1)
#よって回帰式は「統計テスト2=1.1984*統計テスト1+1.6111」
#問題2：統計テスト1と心理学テストを独立変数、統計テスト2を従属変数として回帰式を求める
回帰結果2<-lm(指導法データ$統計テスト2~指導法データ$統計テスト1+指導法データ$心理学テスト)
summary(回帰結果2)
#よって回帰式は「統計テスト2=1.4710*統計テスト1-0.5367*心理学テスト+5.0698」
#問題3：統計テスト（１と2の合計）の得点に対して最も影響の大きい変数は性別、数学、統計のうちどれか
統計テスト合計<-指導法データ$統計テスト1+指導法データ$統計テスト2
回帰結果3<-lm(統計テスト合計~指導法データ$性別+指導法データ$数学+指導法データ$統計)
summary(回帰結果3)
#よって回帰式は「統計テスト合計=-4.2000*性別-0.5455*数学+8.3068*統計+15.9409」
#よって統計テスト（１と2の合計）の得点に対して最も影響の大きい変数は統計である。
#問題4:指導を受ける前の結果が統計テスト1、指導を受けた後の結果が統計テスト2であるとき、どの指導法が最も効果が高いか
指導法Aデータ<-指導法データ[指導法データ$指導法=="A",]
指導法Aデータ
指導法Aデータ回帰結果<-lm(指導法Aデータ$統計テスト2~指導法Aデータ$統計テスト1)
summary(指導法Aデータ回帰結果)
#よって指導法Aの回帰式は「統計テスト2=1.1627*統計テスト1+4.8012」
指導法Bデータ<-指導法データ[指導法データ$指導法=="B",]
指導法Bデータ
指導法Bデータ回帰結果<-lm(指導法Bデータ$統計テスト2~指導法Bデータ$統計テスト1)
summary(指導法Bデータ回帰結果)
#よって指導法Aの回帰式は「統計テスト2=1.0714*統計テスト1+2.1000」
指導法Cデータ<-指導法データ[指導法データ$指導法=="C",]
指導法Cデータ
指導法Cデータ回帰結果<-lm(指導法Cデータ$統計テスト2~指導法Cデータ$統計テスト1)
summary(指導法Cデータ回帰結果)
#よって指導法Aの回帰式は「統計テスト2=0.6321*統計テスト1+5.0283」
指導法Dデータ<-指導法データ[指導法データ$指導法=="D",]
指導法Dデータ
指導法Dデータ回帰結果<-lm(指導法Dデータ$統計テスト2~指導法Dデータ$統計テスト1)
#よって指導法Aの回帰式は「統計テスト2=0.6087*統計テスト1+2.8696」
#よって最も効果が高い指導法はCである。
#問題5:最も効果のある指導法を受けた後の統計テストの平均点は他の指導法と比較して常に最も高くなるか？そうなるもしくはそうならないのにはどのような理由が考えられるか（２つ以上）
mean(指導法Aデータ$統計テスト2-指導法Aデータ$統計テスト1)
mean(指導法Bデータ$統計テスト2-指導法Bデータ$統計テスト1)
mean(指導法Cデータ$統計テスト2-指導法Cデータ$統計テスト1)
mean(指導法Dデータ$統計テスト2-指導法Dデータ$統計テスト1)
#よって平均点が最も高くなるのは指導法Aである。